<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChemBot — Problem Solver</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="hero">
    <div class="wrap">
      <h1>ChemBot</h1>
      <p class="lead">Fast, free, on-device chemistry tools — balanced equations, VSEPR shapes, and simple drawings. No AI key required.</p>
    </div>
  </header>

  <main class="wrap">

    <!-- Periodic Table -->
    <section class="card">
      <div class="section-head">
        <h2>Periodic Table</h2>
        <div class="legend">
          <span class="chip alkali">Alkali</span>
          <span class="chip alkaline">Alkaline Earth</span>
          <span class="chip transition">Transition</span>
          <span class="chip post">Post-Transition</span>
          <span class="chip metalloid">Metalloid</span>
          <span class="chip nonmetal">Nonmetal</span>
          <span class="chip halogen">Halogen</span>
          <span class="chip noble">Noble Gas</span>
          <span class="chip lanth">Lanthanide</span>
          <span class="chip act">Actinide</span>
        </div>
      </div>

      <!-- Hover card -->
      <div class="pt-info" id="pt-info" hidden>
        <div class="pt-big" id="pt-big">
          <div class="num" id="pt-num">—</div>
          <div class="sym" id="pt-sym">—</div>
          <div class="name" id="pt-name">Hover an element</div>
        </div>
        <div class="pt-props">
          <div>Atomic Mass (u) — <b id="pt-mass">—</b></div>
          <div>Symbol — <b id="pt-sym2">—</b></div>
          <div>Chemical Group Block — <b id="pt-block">—</b></div>
        </div>
      </div>

      <!-- Real 18×7 grid + f-block rows -->
      <div id="ptable" class="ptable"></div>
      <div class="fblock-note">* Lanthanides and Actinides shown below</div>
    </section>

    <!-- Solvers -->
    <section class="grid solver-grid">
      <!-- Equation -->
      <div class="card solver">
        <h3>Equation Builder</h3>
        <p class="muted">Enter reactants (with optional products). Examples: <code>Zn + CuSO4</code>, <code>H2 + O2 → H2O</code></p>
        <div class="form">
          <input id="eq-react" type="text" placeholder="e.g., H2 + O2 -> H2O">
          <button id="eq-run" class="primary">Balance</button>
        </div>
        <pre id="eq-out" class="result"></pre>
      </div>

      <!-- VSEPR -->
      <div class="card solver">
        <h3>VSEPR Shape</h3>
        <p class="muted">Give a formula or keyword. Examples: <code>NH3</code>, <code>CO2</code>, <code>C (graphite)</code></p>
        <div class="form">
          <input id="vs-input" type="text" placeholder="e.g., NH3">
          <button id="vs-run" class="primary">Analyze</button>
        </div>
        <div id="vs-svg" class="svgwrap"></div>
        <pre id="vs-out" class="result"></pre>
      </div>

      <!-- Drawings -->
      <div class="card solver">
        <h3>Element Drawings</h3>
        <p class="muted">Simple Bohr / Bohr-Rutherford / Lewis diagrams (first 20 elements supported for now).</p>
        <div class="form">
          <select id="draw-symbol"></select>
          <button id="draw-run" class="primary">Draw</button>
        </div>
        <div class="draw-grid">
          <div><h4>Bohr</h4><div id="svg-bohr" class="svgwrap"></div></div>
          <div><h4>Bohr-Rutherford</h4><div id="svg-br" class="svgwrap"></div></div>
          <div><h4>Lewis</h4><div id="svg-lewis" class="svgwrap"></div></div>
        </div>
        <p id="draw-notes" class="muted" style="margin-top:.6rem;"></p>
      </div>
    </section>

  </main>

  <!-- ===== Local data & solvers (one time) ===== -->
  <script>
  // element numbers + crude valence (first 20 for drawings)
  window.PERIODIC = {
    Z:{H:1,He:2,Li:3,Be:4,B:5,C:6,N:7,O:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,S:16,Cl:17,Ar:18,K:19,Ca:20},
    valence:{H:1,He:0,Li:1,Be:2,B:3,C:4,N:3,O:2,F:1,Ne:0,Na:1,Mg:2,Al:3,Si:4,P:3,S:2,Cl:1,Ar:0,K:1,Ca:2}
  };
  </script>
  <script>
(()=>{ // LocalChem (improved)

  /* ---------- Helpers ---------- */
  function parseFormula(f){const s=[{}];const r=/([A-Z][a-z]?|\(|\)|\d+)/g;let m;
    while((m=r.exec(f))){const t=m[1];
      if(t==='('){s.push({});continue}
      if(t===')'){const top=s.pop();const mult=/^\d+/.exec(f.slice(r.lastIndex))?.[0];const k=mult?parseInt(mult,10):1;if(mult)r.lastIndex+=mult.length;for(const e in top)s[s.length-1][e]=(s[s.length-1][e]||0)+top[e]*k;continue}
      if(/^\d+$/.test(t))continue;const el=t;const mult=/^\d+/.exec(f.slice(r.lastIndex))?.[0];const k=mult?parseInt(mult,10):1;if(mult)r.lastIndex+=mult.length;s[s.length-1][el]=(s[s.length-1][el]||0)+k
    }return s[0]}

  function parseSide(side){return side.split('+').map(x=>{const t=x.trim();const m=/^\s*(\d+)\s+(.+)$/.exec(t);return m?{coef:parseInt(m[1],10),formula:m[2].trim()}:{coef:1,formula:t}})}
  function buildMatrix(lhs,rhs){const sp=[...lhs,...rhs],els=new Set();sp.forEach(p=>{p.comp=parseFormula(p.formula);Object.keys(p.comp).forEach(k=>els.add(k))});
    const e=[...els],C=sp.length,R=e.length,A=[...Array(R)].map(()=>Array(C).fill(0));
    e.forEach((el,i)=>{lhs.forEach((p,j)=>A[i][j]=p.comp[el]||0);rhs.forEach((p,j)=>A[i][j+lhs.length]=-(p.comp[el]||0))});
    return {A,lhs,rhs}}

  /* ---------- Equation balancer + ΔH ---------- */
  const BOND = {"H-H":436,"O=O":498,"C-H":413,"C-C":348,"C=C":614,"C≡C":839,"C=O":799,"O-H":463,"N≡N":945,"N-H":391,"C-O":358};

  // quick library of common molecules → bond counts we can sum
  const MOLECULE_BONDS = {
    "H2": {"H-H":1},
    "O2": {"O=O":1},
    "N2": {"N≡N":1},
    "H2O": {"O-H":2},
    "CO2": {"C=O":2},
    "CO": {"C=O":1},
    "CH4": {"C-H":4},
    "C2H6": {"C-C":1,"C-H":6},
    "C2H4": {"C=C":1,"C-H":4},
    "C2H2": {"C≡C":1,"C-H":2},
    "NH3": {"N-H":3},
    "CH3OH": {"C-O":1,"C-H":4,"O-H":1},
    "C2H5OH": {"C-C":1,"C-H":6,"C-O":1,"O-H":1}
  };

  function bondsFor(formula){
    const key=formula.replace(/\s+/g,'');
    return MOLECULE_BONDS[key] || null;
  }

  function deltaH(reactantsArr, productsArr){
    // Σ(bonds broken) − Σ(bonds formed)
    let broken=0, formed=0;
    for(const {coef,formula} of reactantsArr){
      const b=bondsFor(formula); if(!b) return {deltaH:null, note:"ΔH not estimated for this set (unsupported molecules)."};
      for(const k in b) broken += (BOND[k]||0) * b[k] * coef;
    }
    for(const {coef,formula} of productsArr){
      const b=bondsFor(formula); if(!b) return {deltaH:null, note:"ΔH not estimated for this set (unsupported molecules)."};
      for(const k in b) formed += (BOND[k]||0) * b[k] * coef;
    }
    return {deltaH: Math.round((broken-formed)*10)/10, note:"Estimated from average gas-phase bond energies (kJ/mol)."};
  }

  function balanceEquation(input){
    const [L,R]=input.split('->').map(s=>s.trim());
    if(!L||!R) throw new Error("Use 'reactants -> products'");
    const lhs=parseSide(L), rhs=parseSide(R);
    const {A}=buildMatrix(lhs,rhs);
    const rows=A.length+1, cols=A[0].length, M=[...Array(rows)].map(()=>Array(cols).fill(0));
    for(let i=0;i<A.length;i++)for(let j=0;j<cols;j++)M[i][j]=A[i][j];
    M[rows-1][cols-1]=1; const b=Array(rows).fill(0); b[rows-1]=1;
    const aug=M.map((row,i)=>row.concat([b[i]]));
    const gcd=(a,b)=>b?gcd(b,a%b):Math.abs(a); const lcm=(a,b)=>Math.abs(a*b)/gcd(a,b);
    for(let col=0,row=0; col<cols && row<rows; col++){
      let piv=row; while(piv<rows && aug[piv][col]===0) piv++; if(piv===rows) continue;
      [aug[row],aug[piv]]=[aug[piv],aug[row]]; const pv=aug[row][col];
      for(let c=col;c<=cols;c++) aug[row][c]/=pv;
      for(let r=0;r<rows;r++){ if(r===row) continue; const f=aug[r][col]; if(f!==0) for(let c=col;c<=cols;c++) aug[r][c]-=f*aug[row][c]; }
      row++;
    }
    const x=aug.slice(0,cols).map(r=>r[cols]||0);
    const den=x.map(v=>{const s=v.toString(); return s.includes('.')?10**s.split('.')[1].length:1});
    const LCM=den.reduce((p,c)=>lcm(p,c),1);
    let nums=x.map(v=>Math.round(v*LCM));
    const G=nums.reduce((p,c)=>gcd(p,c),nums[0]||1); nums=nums.map(v=>Math.abs(v/G));

    const left=lhs.map((p,i)=>({coef:nums[i], formula:p.formula}));
    const right=rhs.map((p,i)=>({coef:nums[i+lhs.length], formula:p.formula}));
    const lstr=left.map(p=>`${p.coef===1?'':p.coef+' '}${p.formula}`).join(' + ');
    const rstr=right.map(p=>`${p.coef===1?'':p.coef+' '}${p.formula}`).join(' + ');

    const dH=deltaH(left,right);
    return {balanced:`${lstr} -> ${rstr}`, left, right, dH};
  }

  async function localSolveEquation(inp){
    const s = inp.includes('->') ? inp : `${inp} -> H2O`;
    const res = balanceEquation(s);
    return {
      balanced_equation: res.balanced,
      products: res.right.map(p=>p.formula),
      reaction_type: "balanced",
      enthalpy_kJ_per_mol: res.dH.deltaH,
      notes: res.dH.note || "Balanced locally (static mode).",
      steps: [
        "1) Build element matrix",
        "2) Solve for smallest integer coefficients",
        "3) Normalize to whole-number stoichiometry"
      ]
    };
  }

  /* ---------- Drawings with electrons (white) ---------- */
  function shells(z){const s=[];let left=z;const cap=[2,8,8,18];for(let i=0;i<cap.length&&left>0;i++){const take=Math.min(cap[i],left);s.push(take);left-=take}return s}
  function bohrSVG(symbol,z){
    const sh=shells(z);
    const dots = sh.map((n,i)=>{
      const R=40+30*i;
      return Array.from({length:n}).map((_,k)=>{
        const a=(k/n)*2*Math.PI;
        const x=200+R*Math.cos(a), y=150+R*Math.sin(a);
        return `<circle class="wfill" cx="${x.toFixed(1)}" cy="${y.toFixed(1)}" r="3"/>`;
      }).join('');
    }).join('');
    return `<svg viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
      <circle class="wfill" cx="200" cy="150" r="8"/>
      ${sh.map((_,i)=>`<circle class="wstroke" cx="200" cy="150" r="${40+30*i}"/>`).join('')}
      ${dots}
      <text x="200" y="290" text-anchor="middle" font-family="Inter,system-ui,sans-serif" font-size="14" fill="#fff">${symbol}</text>
    </svg>`;
  }
  function lewisSVG(symbol,v){
    const pts = Array.from({length:v}).map((_,i)=>{
      const a=(i/v)*2*Math.PI, R=70, x=200+R*Math.cos(a), y=150+R*Math.sin(a);
      return `<circle class="wfill" cx="${x.toFixed(1)}" cy="${y.toFixed(1)}" r="5"/>`;
    }).join('');
    return `<svg viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
      <text x="200" y="160" text-anchor="middle" font-family="Inter,system-ui,sans-serif" font-size="64" fill="#fff">${symbol}</text>
      ${pts}
    </svg>`;
  }

  async function localDrawElement(symbol){
    const Z=PERIODIC.Z[symbol]; if(!Z) return {error:"Unknown element"};
    const sh=shells(Z); const v=PERIODIC.valence[symbol]??(sh.at(-1)||0);
    const bohr = bohrSVG(symbol,Z);
    const br = bohr; // simple BR = Bohr for now (nucleus already shown)
    const lewis = lewisSVG(symbol,v);
    return { valence_electrons:v, bohr, bohr_rutherford:br, lewis, notes:"Bohr models with electrons; first 20 elements best supported." };
  }

  /* ---------- VSEPR: electron geometry + molecular geometry + drawing ---------- */
  const EG = {2:"linear",3:"trigonal planar",4:"tetrahedral",5:"trigonal bipyramidal",6:"octahedral"};
  function vseprFromCount(bonds,lone){
    const ed=bonds+lone, eg=EG[ed]||"unknown";
    let mg=eg;
    if(ed===3 && lone===1) mg="bent";
    if(ed===4 && lone===1) mg="trigonal pyramidal";
    if(ed===4 && lone===2) mg="bent";
    if(ed===5 && lone===1) mg="seesaw";
    if(ed===5 && lone===2) mg="T-shaped";
    if(ed===5 && lone===3) mg="linear";
    if(ed===6 && lone===1) mg="square pyramidal";
    if(ed===6 && lone===2) mg="square planar";
    return {electron_geometry:eg, molecular_geometry:mg, ed};
  }

  function drawVSEPR(mg){
    // Simple 2D white sketch; central at (200,150)
    const C="class='wstroke'", F="class='wfill'";
    const center=`<circle ${F} cx="200" cy="150" r="6"/>`;
    const lines=(pts)=>pts.map(([x,y])=>`<line ${C} x1="200" y1="150" x2="${x}" y2="${y}"/>`).join('');
    const balls=(pts)=>pts.map(([x,y])=>`<circle ${F} cx="${x}" cy="${y}" r="6"/>`).join('');
    let pts=[];
    switch(mg){
      case "linear": pts=[[110,150],[290,150]]; break;
      case "trigonal planar": pts=[[200,70],[140,210],[260,210]]; break;
      case "bent": pts=[[150,200],[250,200]]; break;
      case "tetrahedral": pts=[[200,70],[110,200],[290,200],[200,230]]; break;
      case "trigonal pyramidal": pts=[[200,70],[130,210],[270,210]]; break;
      case "seesaw": pts=[[110,150],[290,150],[200,70],[200,230]]; break;
      case "T-shaped": pts=[[110,150],[290,150],[200,70]]; break;
      case "square planar": pts=[[140,110],[260,110],[140,190],[260,190]]; break;
      case "square pyramidal": pts=[[200,70],[140,110],[260,110],[140,190],[260,190]]; break;
      case "octahedral": pts=[[200,60],[200,240],[120,150],[280,150],[140,110],[260,190]]; break;
      default: pts=[[200,70],[140,210],[260,210]];
    }
    return `<svg viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">${center}${lines(pts)}${balls(pts)}</svg>`;
  }

  function estimateCounts(formula){
    // crude: central = first element token
    const m=/^([A-Z][a-z]?)/.exec(formula.replace(/\s+/g,'')); const central=m?m[1]:"X";
    const tokens=(formula.replace(/\s+/g,'').match(/[A-Z][a-z]?\d*/g)||[]);
    const counts={}; tokens.forEach(tok=>{const el=/^[A-Z][a-z]?/.exec(tok)[0]; const n=parseInt(tok.slice(el.length)||"1",10); counts[el]=(counts[el]||0)+n;});
    const bonds=Object.entries(counts).reduce((a,[el,n])=>el===central?a:a+n,0);
    const val=PERIODIC.valence[central]??4; const lone=Math.max(0,val-bonds);
    return {central, bonds, lone};
  }

  async function localSolveVSEPR(input){
    const f=input.replace(/granite/ig,'graphite'); // typo guard
    const {bonds,lone}=estimateCounts(f);
    const shape=vseprFromCount(bonds,lone);
    const svg=drawVSEPR(shape.molecular_geometry);
    return {
      system:"molecule",
      formula:f,
      electron_geometry: shape.electron_geometry,
      molecular_geometry: shape.molecular_geometry,
      electron_domains: `${bonds+lone} (${bonds} bonding + ${lone} lone)`,
      bond_angles_deg: shape.electron_geometry==="tetrahedral"?"~109.5°":shape.electron_geometry==="trigonal planar"?"~120°":shape.electron_geometry==="linear"?"180°":shape.electron_geometry==="octahedral"?"90°":"varies",
      hybridization: shape.electron_geometry==="linear"?"sp":shape.electron_geometry==="trigonal planar"?"sp2":shape.electron_geometry==="tetrahedral"?"sp3":shape.electron_geometry==="trigonal bipyramidal"?"sp3d":shape.electron_geometry==="octahedral"?"sp3d2":"—",
      svg
    };
  }

  /* expose */
  window.LocalChem={ localSolveEquation, localDrawElement, localSolveVSEPR };

})();
</script>

  <!-- Table renderer -->
  <script>
  (()=>{
    const grid = document.getElementById('ptable');
    if(!grid) return;

    // 18×7 main grid with explicit gaps, then row8/9 for f-block
    grid.style.setProperty('--cols', 18);

    // dataset: [Z, sym, name, mass, col, row, block]
    const main = [
      [1,"H","Hydrogen",1.008,1,1,"Nonmetal"],
      [2,"He","Helium",4.0026,18,1,"Noble Gas"],
      [3,"Li","Lithium",6.94,1,2,"Alkali Metal"],[4,"Be","Beryllium",9.0122,2,2,"Alkaline Earth Metal"],
      [5,"B","Boron",10.81,13,2,"Metalloid"],[6,"C","Carbon",12.011,14,2,"Nonmetal"],[7,"N","Nitrogen",14.007,15,2,"Nonmetal"],[8,"O","Oxygen",15.999,16,2,"Nonmetal"],[9,"F","Fluorine",18.998,17,2,"Halogen"],[10,"Ne","Neon",20.18,18,2,"Noble Gas"],
      [11,"Na","Sodium",22.99,1,3,"Alkali Metal"],[12,"Mg","Magnesium",24.305,2,3,"Alkaline Earth Metal"],
      [13,"Al","Aluminum",26.982,13,3,"Post-Transition Metal"],[14,"Si","Silicon",28.085,14,3,"Metalloid"],[15,"P","Phosphorus",30.974,15,3,"Nonmetal"],[16,"S","Sulfur",32.06,16,3,"Nonmetal"],[17,"Cl","Chlorine",35.45,17,3,"Halogen"],[18,"Ar","Argon",39.95,18,3,"Noble Gas"],
      [19,"K","Potassium",39.098,1,4,"Alkali Metal"],[20,"Ca","Calcium",40.078,2,4,"Alkaline Earth Metal"],
      [21,"Sc","Scandium",44.956,3,4,"Transition Metal"],[22,"Ti","Titanium",47.867,4,4,"Transition Metal"],[23,"V","Vanadium",50.942,5,4,"Transition Metal"],[24,"Cr","Chromium",51.996,6,4,"Transition Metal"],[25,"Mn","Manganese",54.938,7,4,"Transition Metal"],[26,"Fe","Iron",55.845,8,4,"Transition Metal"],[27,"Co","Cobalt",58.933,9,4,"Transition Metal"],[28,"Ni","Nickel",58.693,10,4,"Transition Metal"],[29,"Cu","Copper",63.546,11,4,"Transition Metal"],[30,"Zn","Zinc",65.38,12,4,"Transition Metal"],
      [31,"Ga","Gallium",69.723,13,4,"Post-Transition Metal"],[32,"Ge","Germanium",72.63,14,4,"Metalloid"],[33,"As","Arsenic",74.922,15,4,"Metalloid"],[34,"Se","Selenium",78.971,16,4,"Nonmetal"],[35,"Br","Bromine",79.904,17,4,"Halogen"],[36,"Kr","Krypton",83.798,18,4,"Noble Gas"],
      [37,"Rb","Rubidium",85.468,1,5,"Alkali Metal"],[38,"Sr","Strontium",87.62,2,5,"Alkaline Earth Metal"],
      [39,"Y","Yttrium",88.906,3,5,"Transition Metal"],[40,"Zr","Zirconium",91.224,4,5,"Transition Metal"],[41,"Nb","Niobium",92.906,5,5,"Transition Metal"],[42,"Mo","Molybdenum",95.95,6,5,"Transition Metal"],[43,"Tc","Technetium",98,7,5,"Transition Metal"],[44,"Ru","Ruthenium",101.07,8,5,"Transition Metal"],[45,"Rh","Rhodium",102.906,9,5,"Transition Metal"],[46,"Pd","Palladium",106.42,10,5,"Transition Metal"],[47,"Ag","Silver",107.868,11,5,"Transition Metal"],[48,"Cd","Cadmium",112.414,12,5,"Transition Metal"],[49,"In","Indium",114.818,13,5,"Post-Transition Metal"],[50,"Sn","Tin",118.71,14,5,"Post-Transition Metal"],[51,"Sb","Antimony",121.76,15,5,"Metalloid"],[52,"Te","Tellurium",127.6,16,5,"Metalloid"],[53,"I","Iodine",126.904,17,5,"Halogen"],[54,"Xe","Xenon",131.293,18,5,"Noble Gas"],
      [55,"Cs","Cesium",132.905,1,6,"Alkali Metal"],[56,"Ba","Barium",137.33,2,6,"Alkaline Earth Metal"],
      [72,"Hf","Hafnium",178.49,4,6,"Transition Metal"],[73,"Ta","Tantalum",180.947,5,6,"Transition Metal"],[74,"W","Tungsten",183.84,6,6,"Transition Metal"],[75,"Re","Rhenium",186.207,7,6,"Transition Metal"],[76,"Os","Osmium",190.23,8,6,"Transition Metal"],[77,"Ir","Iridium",192.217,9,6,"Transition Metal"],[78,"Pt","Platinum",195.08,10,6,"Transition Metal"],[79,"Au","Gold",196.967,11,6,"Transition Metal"],[80,"Hg","Mercury",200.59,12,6,"Transition Metal"],[81,"Tl","Thallium",204.38,13,6,"Post-Transition Metal"],[82,"Pb","Lead",207.2,14,6,"Post-Transition Metal"],[83,"Bi","Bismuth",208.98,15,6,"Post-Transition Metal"],[84,"Po","Polonium",209,16,6,"Metalloid"],[85,"At","Astatine",210,17,6,"Halogen"],[86,"Rn","Radon",222,18,6,"Noble Gas"],
      [87,"Fr","Francium",223,1,7,"Alkali Metal"],[88,"Ra","Radium",226,2,7,"Alkaline Earth Metal"],
      [104,"Rf","Rutherfordium",267,4,7,"Transition Metal"],[105,"Db","Dubnium",268,5,7,"Transition Metal"],[106,"Sg","Seaborgium",269,6,7,"Transition Metal"],[107,"Bh","Bohrium",270,7,7,"Transition Metal"],[108,"Hs","Hassium",269,8,7,"Transition Metal"],[109,"Mt","Meitnerium",278,9,7,"Transition Metal"],[110,"Ds","Darmstadtium",281,10,7,"Transition Metal"],[111,"Rg","Roentgenium",282,11,7,"Transition Metal"],[112,"Cn","Copernicium",285,12,7,"Transition Metal"],[113,"Nh","Nihonium",286,13,7,"Post-Transition Metal"],[114,"Fl","Flerovium",289,14,7,"Post-Transition Metal"],[115,"Mc","Moscovium",290,15,7,"Post-Transition Metal"],[116,"Lv","Livermorium",293,16,7,"Post-Transition Metal"],[117,"Ts","Tennessine",294,17,7,"Halogen"],[118,"Og","Oganesson",295,18,7,"Noble Gas"]
    ];
    const lan = [[57,"La","Lanthanum"],[58,"Ce","Cerium"],[59,"Pr","Praseodymium"],[60,"Nd","Neodymium"],[61,"Pm","Promethium"],[62,"Sm","Samarium"],[63,"Eu","Europium"],[64,"Gd","Gadolinium"],[65,"Tb","Terbium"],[66,"Dy","Dysprosium"],[67,"Ho","Holmium"],[68,"Er","Erbium"],[69,"Tm","Thulium"],[70,"Yb","Ytterbium"],[71,"Lu","Lutetium"]];
    const act = [[89,"Ac","Actinium"],[90,"Th","Thorium"],[91,"Pa","Protactinium"],[92,"U","Uranium"],[93,"Np","Neptunium"],[94,"Pu","Plutonium"],[95,"Am","Americium"],[96,"Cm","Curium"],[97,"Bk","Berkelium"],[98,"Cf","Californium"],[99,"Es","Einsteinium"],[100,"Fm","Fermium"],[101,"Md","Mendelevium"],[102,"No","Nobelium"],[103,"Lr","Lawrencium"]];

    const blockClass = b=>{
      const k = b.toLowerCase();
      if(k.includes('alkali') && !k.includes('earth')) return 'pt-alkali';
      if(k.includes('alkaline')||k.includes('earth')) return 'pt-alkaline';
      if(k.includes('transition')) return 'pt-transition';
      if(k.includes('post')) return 'pt-post';
      if(k.includes('metalloid')) return 'pt-metalloid';
      if(k.includes('nonmetal')) return 'pt-nonmetal';
      if(k.includes('halogen')) return 'pt-halogen';
      if(k.includes('noble')) return 'pt-noble';
      if(k.includes('lanthan')) return 'pt-lanth';
      if(k.includes('actin')) return 'pt-act';
      return '';
    };

    // Render helper
    const makeTile = (Z,sym,name,mass,col,row,block)=>{
      const d = document.createElement('div');
      d.className = `elem ${blockClass(block)}`;
      d.style.gridColumn = col;
      d.style.gridRow = row;
      d.innerHTML = `
        <div class="num">${Z}</div>
        <div class="sym">${sym}</div>
        <div class="name">${name}</div>
        <div class="mass">${typeof mass==='number'?mass:''}</div>
      `;
      d.dataset.block=block; d.dataset.z=Z; d.dataset.sym=sym; d.dataset.name=name; d.dataset.mass = (mass??'—');
      return d;
    };

    // Draw main
    grid.innerHTML = '';
    main.forEach(e=>grid.appendChild(makeTile(...e)));

    // f-block rows 8 & 9
    lan.forEach((x,i)=>grid.appendChild(makeTile(x[0],x[1],x[2],undefined,3+i,8,'Lanthanide')));
    act.forEach((x,i)=>grid.appendChild(makeTile(x[0],x[1],x[2],undefined,3+i,9,'Actinide')));

    // Hover card
    const info = document.getElementById('pt-info');
    const setInfo = (t)=>{
      info.hidden = false;
      info.querySelector('#pt-num').textContent = t.dataset.z;
      info.querySelector('#pt-sym').textContent = t.dataset.sym;
      info.querySelector('#pt-name').textContent = t.dataset.name;
      info.querySelector('#pt-sym2').textContent = t.dataset.sym;
      info.querySelector('#pt-mass').textContent = t.dataset.mass;
      info.querySelector('#pt-block').textContent = t.dataset.block;
      document.getElementById('pt-big').style.background = getComputedStyle(t).backgroundImage || getComputedStyle(t).backgroundColor;
    };
    grid.addEventListener('mouseover', e=>{ const t=e.target.closest('.elem'); if(t) setInfo(t); });
    grid.addEventListener('click', e=>{ const t=e.target.closest('.elem'); if(t) setInfo(t); });
  })();
  </script>

  <!-- UI logic -->
  <script src="app.js" defer></script>
</body>
</html>

