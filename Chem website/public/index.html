<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChemBot ‚Äî Problem Solver</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root { --bg:#0b1020; --card:#111834; --text:#e9ecff; --muted:#aab0d6; --accent:#6ea8ff; --card2:#0d1333; }
    *{ box-sizing:border-box; }
    body{ margin:0; font-family:Inter,system-ui,Arial; background:linear-gradient(180deg,#0b1020,#0e1430); color:var(--text); }
    .wrap{ max-width:1100px; margin:40px auto; padding:0 16px; }
    .hero{ text-align:center; margin-bottom:24px; }
    h1{ font-size:32px; margin:0 0 6px; }
    p.lead{ color:var(--muted); margin:0 0 24px; }
    .card{ background:var(--card); border-radius:16px; padding:16px; box-shadow:0 10px 30px rgba(0,0,0,.35); }
    .grid{ display:grid; gap:12px; }
    .solver-grid{ grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); margin-top:16px; }
    .solver{ background:var(--card2); border:1px solid #243063; border-radius:14px; padding:16px; cursor:pointer; transition:transform .08s ease; }
    .solver:hover{ transform:translateY(-2px); border-color:#3e58b3; }
    .solver h3{ margin:0 0 8px; font-size:18px; }
    .solver p{ margin:0; color:var(--muted); font-size:14px; }
    .footer{ text-align:center; color:#93a1d8; font-size:12px; margin-top:28px; }

    /* Periodic table */
    .ptable{ display:grid; grid-template-columns:repeat(18, minmax(28px, 1fr)); gap:6px; }
    .elem{ background:#0b1030; border:1px solid #243063; border-radius:10px; padding:6px; text-align:center; position:relative; }
    .elem .num{ position:absolute; top:4px; left:6px; font-size:10px; color:#8fa0de; }
    .elem .sym{ font-size:14px; font-weight:700; }
    .elem .name{ font-size:10px; color:#8fa0de; }
    .empty{ visibility:hidden; }

    /* Views */
    .view{ display:none; }
    .view.active{ display:block; }

    .form{ display:flex; gap:10px; }
    input[type=text], select{ flex:1; background:#0b1030; color:var(--text); border:1px solid #243063; border-radius:12px; padding:12px; }
    button{ background:var(--accent); color:#071122; border:0; padding:12px 16px; border-radius:12px; font-weight:600; cursor:pointer; }
    button:disabled{ opacity:.6; cursor:not-allowed; }
    .result{ margin-top:16px; background:#0b1030; padding:14px; border-radius:12px; border:1px solid #243063; white-space:pre-wrap; }
    .back{ background:#233066; margin-bottom:12px; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .svgwrap{ margin-top:12px; background:#0b1030; border:1px solid #243063; border-radius:12px; padding:12px; }
    .cols{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:12px; }
  </style>
  <script>
  const API_BASE = "https://chem-problem-solver.onrender.com";
</script>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <h1>üî¨ ChemBot ‚Äî Problem Solver</h1>
      <p class="lead">A single-page toolkit for students: interactive periodic table and guided solvers. No chats, just answers.</p>
    </div>

    <!-- HOME VIEW -->
    <section id="home" class="view active">
      <div class="card" style="margin-bottom:16px;">
        <h2 style="margin:0 0 12px;">Periodic Table</h2>
        <div id="ptable" class="ptable"></div>
      </div>

      <div class="card">
        <h2 style="margin:0 0 8px;">Problem Solvers</h2>
        <div class="grid solver-grid">
          <div class="solver" data-view="equation">
            <h3>Equation Builder</h3>
            <p>Enter reactants ‚Üí products, balanced equation, type, and ŒîH estimate.</p>
          </div>
          <div class="solver" data-view="vsepr">
            <h3>Bond Shapes & VSEPR</h3>
            <p>Enter a molecule or allotrope (e.g., NH3, C (graphite)) ‚Üí shape, hybridization, SVG sketch.</p>
          </div>
          <div class="solver" data-view="drawings">
            <h3>Structure Drawings</h3>
            <p>Bohr, Bohr‚ÄëRutherford, and Lewis dot diagrams ‚Äî pick an element.</p>
          </div>
          <div class="solver" data-view="stoich">
            <h3>Stoichiometry Solver</h3>
            <p>Mass, moles, limiting reagent, percent yield. (Coming next)</p>
          </div>
          <div class="solver" data-view="solutions">
            <h3>Solutions & Concentration</h3>
            <p>Compute dilutions with <span class="mono">C‚ÇÅV‚ÇÅ = C‚ÇÇV‚ÇÇ</span>.</p>
          </div>
          <div class="solver" data-view="advanced">
            <h3>Advanced (University)</h3>
            <p>Thermo, quantum, spectroscopy, equilibrium ‚Äî structured solutions.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- EQUATION BUILDER VIEW -->
    <section id="equation" class="view">
      <button class="back" onclick="switchView('home')">‚Üê Back</button>
      <div class="card">
        <h2 style="margin:0 0 8px;">Equation Builder</h2>
        <p class="lead">Type reactants (e.g., <span class="mono">Zn + CuSO4</span>). The AI will balance, classify, and estimate ŒîH.</p>
        <div class="form">
          <input id="eq-react" type="text" placeholder="e.g., Zn + CuSO4" />
          <button id="eq-run">Solve</button>
        </div>
        <div id="eq-out" class="result">Results will appear here.</div>
      </div>
    </section>

    <!-- VSEPR VIEW -->
    <section id="vsepr" class="view">
      <button class="back" onclick="switchView('home')">‚Üê Back</button>
      <div class="card">
        <h2 style="margin:0 0 8px;">Bond Shapes & VSEPR</h2>
        <p class="lead">Enter a molecule or carbon allotrope (e.g., <span class="mono">NH3</span>, <span class="mono">CO2</span>, <span class="mono">C (graphite)</span>).</p>
        <div class="form">
          <input id="vs-input" type="text" placeholder="e.g., NH3" />
          <button id="vs-run">Analyze</button>
        </div>
        <div id="vs-out" class="result">Shape, hybridization, and notes will appear here.</div>
        <div id="vs-svg" class="svgwrap"></div>
      </div>
    </section>

    <!-- DRAWINGS VIEW -->
    <section id="drawings" class="view">
      <button class="back" onclick="switchView('home')">‚Üê Back</button>
      <div class="card">
        <h2 style="margin:0 0 8px;">Structure Drawings</h2>
        <div class="form">
          <select id="draw-symbol"></select>
          <button id="draw-run">Draw</button>
        </div>
        <div class="cols">
          <div>
            <h3>Bohr</h3>
            <div id="svg-bohr" class="svgwrap"></div>
          </div>
          <div>
            <h3>Bohr‚ÄëRutherford</h3>
            <div id="svg-br" class="svgwrap"></div>
          </div>
          <div>
            <h3>Lewis Dot</h3>
            <div id="svg-lewis" class="svgwrap"></div>
          </div>
        </div>
        <div id="draw-notes" class="result"></div>
      </div>
    </section>

    <!-- Placeholder VIEWS -->
    <section id="stoich" class="view">
      <button class="back" onclick="switchView('home')">‚Üê Back</button>
      <div class="card"><h2>Stoichiometry Solver</h2><p>Coming next ‚Äî tell me the fields you want (e.g., given mass, target product, etc.).</p></div>
    </section>

    <section id="solutions" class="view">
      <button class="back" onclick="switchView('home')">‚Üê Back</button>
      <div class="card"><h2>Solutions & Concentration</h2><p>Use the dilution identity <span class="mono">C‚ÇÅV‚ÇÅ = C‚ÇÇV‚ÇÇ</span>. (We can add inputs and calculator next.)</p></div>
    </section>

    <section id="advanced" class="view">
      <button class="back" onclick="switchView('home')">‚Üê Back</button>
      <div class="card">
        <h2>Advanced (University)</h2>
        <p class="lead">Pick a topic and describe your problem.</p>
        <div class="form">
          <select id="adv-topic">
            <option value="thermo">Thermodynamics</option>
            <option value="equilibrium">Chemical Equilibrium</option>
            <option value="spectroscopy">Spectroscopy</option>
            <option value="quantum">Quantum / MO Theory</option>
          </select>
          <input id="adv-prompt" type="text" placeholder="e.g., Calculate ŒîG for reaction at 298 K given ŒîH and ŒîS." />
          <button id="adv-run">Solve</button>
        </div>
        <div id="adv-out" class="result">Outline, formulas, and result will appear here.</div>
      </div>
    </section>

    <div class="footer">Built for learning. Answers only; no hazardous how‚Äëto instructions.</div>
  </div>

<script>
  // View switcher
  function switchView(id){
    document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
    const el = document.getElementById(id);
    if (el) el.classList.add('active');
    window.scrollTo({ top:0, behavior:'smooth' });
  }

  document.addEventListener('DOMContentLoaded', () => {
    // Tile clicks
    document.querySelectorAll('.solver').forEach(card=>{
      const view = card.getAttribute('data-view');
      if(view) card.addEventListener('click', ()=> switchView(view));
    });

    // ---------- Equation Builder ----------
    const runBtn = document.getElementById('eq-run');
    const reactEl = document.getElementById('eq-react');
    const eqOut  = document.getElementById('eq-out');

    function setEqLoading(b){
      if (!runBtn) return;
      runBtn.disabled = b;
      runBtn.textContent = b ? 'Solving‚Ä¶' : 'Solve';
    }

    if (runBtn) {
      runBtn.addEventListener('click', async () => {
        const reactants = (reactEl?.value || '').trim();
        if (!reactants) return;
        setEqLoading(true);
        if (eqOut) eqOut.textContent = '';
        try {
          const r = await fetch(`${API_BASE}/api/solve/equation`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ reactants })
          });
          const data = await r.json();
          if (data.error) {
            eqOut.textContent = data.error;
          } else {
            const lines = [];
            if (data.balanced_equation) lines.push(`Balanced: ${data.balanced_equation}`);
            if (Array.isArray(data.products)) lines.push(`Products: ${data.products.join(', ')}`);
            if (data.reaction_type) lines.push(`Type: ${data.reaction_type}`);
            if (typeof data.enthalpy_kJ_per_mol !== 'undefined')
              lines.push(`ŒîH ‚âà ${data.enthalpy_kJ_per_mol} kJ`);
            if (data.notes) lines.push(`Notes: ${data.notes}`);
            eqOut.textContent = lines.join('\n') || 'No data.';
          }
        } catch {
          eqOut.textContent = 'Network error.';
        } finally {
          setEqLoading(false);
        }
      });
    }

    // ---------- VSEPR ----------
    const vsBtn  = document.getElementById('vs-run');
    const vsIn   = document.getElementById('vs-input');
    const vsOut  = document.getElementById('vs-out');
    const vsSvg  = document.getElementById('vs-svg');

    function setVsLoading(b){
      if (!vsBtn) return;
      vsBtn.disabled = b;
      vsBtn.textContent = b ? 'Analyzing‚Ä¶' : 'Analyze';
    }

    if (vsBtn) {
      vsBtn.addEventListener('click', async () => {
        const input = (vsIn?.value || '').trim();
        if (!input) return;
        setVsLoading(true);
        if (vsOut) vsOut.textContent = '';
        if (vsSvg) vsSvg.innerHTML = '';
        try {
          const r = await fetch(`${API_BASE}/api/solve/vsepr`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ input })
          });
          const data = await r.json();
          if (data.error) {
            vsOut.textContent = data.error;
          } else {
            const lines = [];
            if (data.name) lines.push(`Name: ${data.name}`);
            if (data.formula) lines.push(`Formula: ${data.formula}`);
            if (data.system) lines.push(`System: ${data.system}`);
            if (data.shape) lines.push(`Shape: ${data.shape}`);
            if (data.electron_domains) lines.push(`Electron domains: ${data.electron_domains}`);
            if (data.bond_angles_deg) lines.push(`Bond angles: ${data.bond_angles_deg}`);
            if (data.hybridization) lines.push(`Hybridization: ${data.hybridization}`);
            if (data.bond_count) lines.push(`Bond count: ${data.bond_count}`);
            if (data.description) lines.push(`Notes: ${data.description}`);
            vsOut.textContent = lines.join('\n') || 'No data.';
            if (data.svg && vsSvg) vsSvg.innerHTML = data.svg;
          }
        } catch {
          vsOut.textContent = 'Network error.';
        } finally {
          setVsLoading(false);
        }
      });
    }

    // ---------- Drawings ----------
    const drawBtn   = document.getElementById('draw-run');
    const drawSel   = document.getElementById('draw-symbol');
    const svgBohr   = document.getElementById('svg-bohr');
    const svgBR     = document.getElementById('svg-br');
    const svgLewis  = document.getElementById('svg-lewis');
    const drawNotes = document.getElementById('draw-notes');

    function setDrawLoading(b){
      if (!drawBtn) return;
      drawBtn.disabled = b;
      drawBtn.textContent = b ? 'Drawing‚Ä¶' : 'Draw';
    }

    if (drawBtn) {
      drawBtn.addEventListener('click', async () => {
        const symbol = drawSel?.value;
        if (!symbol) return;
        setDrawLoading(true);
        if (svgBohr)  svgBohr.innerHTML  = '';
        if (svgBR)    svgBR.innerHTML    = '';
        if (svgLewis) svgLewis.innerHTML = '';
        if (drawNotes) drawNotes.textContent = '';
        try {
          const r = await fetch(`${API_BASE}/api/draw/element`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ symbol })
          });
          const data = await r.json();
          if (data.error) {
            drawNotes.textContent = data.error;
          } else {
            if (data.bohr && svgBohr) svgBohr.innerHTML = data.bohr;
            if (data.bohr_rutherford && svgBR) svgBR.innerHTML = data.bohr_rutherford;
            if (data.lewis && svgLewis) svgLewis.innerHTML = data.lewis;
            const extras = [];
            if (typeof data.valence_electrons !== 'undefined')
              extras.push(`Valence electrons: ${data.valence_electrons}`);
            if (data.notes) extras.push(data.notes);
            if (drawNotes) drawNotes.textContent = extras.join('\n');
          }
        } catch {
          if (drawNotes) drawNotes.textContent = 'Network error.';
        } finally {
          setDrawLoading(false);
        }
      });
    }
  });
</script>
</body>
</html>







